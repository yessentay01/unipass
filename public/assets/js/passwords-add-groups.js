var tableGruposDisponiveis,checkAdicionarGrupo;function carregarGruposDisponiveis(){tableGruposDisponiveis.block(),tableGruposDisponiveis.api().ajax.url("api/passwords/"+senhaId+"/groups/available").load(function(){tableGruposDisponiveis.unblock()})}$("#btnGruposAdicionar").click(function(){$("#modalGruposDisponiveis").modal("show"),carregarGruposDisponiveis(),checkAdicionarGrupo=[]}),(tableGruposDisponiveis=$("#tableGruposDisponiveis").dataTable({autoWidth:!1,order:[1,"asc"],deferLoading:0,buttons:[],columns:[{data:"id",orderable:!1,className:"align-middle v-middle",render:function(n){return'<label class="custom-control custom-checkbox m-0"><input type="checkbox" class="custom-control-input btnCheckGrupo" data-id="'+n+'"><span class="custom-control-label">&nbsp;</span></label>'}},{data:"name",width:"45%"},{data:"id",width:"55%",orderable:!1,render:function(n){return'<div data-group="'+n+'"><label class="custom-control custom-checkbox custom-control-inline mb-0"><input type="checkbox" class="custom-control-input" name="can_view" checked disabled><span class="custom-control-label">Visualizar</span></label><label class="custom-control custom-checkbox custom-control-inline mb-0"><input type="checkbox" class="custom-control-input" name="can_edit"><span class="custom-control-label">Editar</span></label><label class="custom-control custom-checkbox custom-control-inline mb-0"><input type="checkbox" class="custom-control-input" name="can_delete"><span class="custom-control-label">Excluir</span></label><label class="custom-control custom-checkbox custom-control-inline mb-0"><input type="checkbox" class="custom-control-input" name="can_share"><span class="custom-control-label">Compartilhar</span></label></div>'}}],drawCallback:function(){$("#tableGruposDisponiveis").find('input[name="can_view"], input[name="can_edit"], input[name="can_delete"], input[name="can_share"]').on("change",function(){let n=$(this).parents("div"),a=n.attr("data-group");checkAdicionarGrupo=checkAdicionarGrupo.filter(function(e){return e.group_id==a&&(e.can_view=n.find('input[name="can_view"]').is(":checked")?1:0,e.can_edit=n.find('input[name="can_edit"]').is(":checked")?1:0,e.can_delete=n.find('input[name="can_delete"]').is(":checked")?1:0,e.can_share=n.find('input[name="can_share"]').is(":checked")?1:0),!0})})}})).on("click","tbody > tr .btnCheckGrupo",function(){var n=$(this).attr("data-id");$(this).is(":checked")?checkAdicionarGrupo.push({password_id:senhaId,group_id:n,can_view:$(this).parents("tr").find('input[name="can_view"]').is(":checked")?1:0,can_edit:$(this).parents("tr").find('input[name="can_edit"]').is(":checked")?1:0,can_delete:$(this).parents("tr").find('input[name="can_delete"]').is(":checked")?1:0,can_share:$(this).parents("tr").find('input[name="can_share"]').is(":checked")?1:0}):checkAdicionarGrupo=checkAdicionarGrupo.filter(function(a){return a.group_id!=n}),$("#btnGruposSalvar").toggleClass("disabled",0===checkAdicionarGrupo.length)}),$("#btnGruposSalvar").click(function(){let n="shareds="+JSON.stringify(checkAdicionarGrupo),a=$("#modalGruposDisponiveis"),e=a.find(".modal-content");e.block(),$.request({url:"api/passwords/"+senhaId+"/shareds",method:"POST",data:n,error:function(){e.unblock()},after:function(){$.notify({message:"Senha compartilhada"},{type:"success"}),carregarCompartilhamentos(),a.modal("hide"),e.unblock()}})});